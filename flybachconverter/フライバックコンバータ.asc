Version 4
SHEET 1 2116 1156
WIRE 48 -208 -96 -208
WIRE 400 -208 48 -208
WIRE 1200 -208 400 -208
WIRE 48 -160 48 -208
WIRE 224 -144 160 -144
WIRE 400 -128 400 -144
WIRE 496 -128 400 -128
WIRE 528 -128 496 -128
WIRE 608 -128 592 -128
WIRE 672 -128 608 -128
WIRE 1200 -128 1200 -208
WIRE 1600 -128 1312 -128
WIRE 1776 -128 1600 -128
WIRE 1968 -128 1776 -128
WIRE 2048 -128 1968 -128
WIRE 224 -96 224 -128
WIRE 400 -96 400 -128
WIRE 496 -96 496 -128
WIRE 608 -96 608 -128
WIRE -96 -80 -96 -208
WIRE 176 -64 144 -64
WIRE 1200 -48 1152 -48
WIRE 1408 -48 1312 -48
WIRE 48 -32 48 -80
WIRE 144 -32 144 -64
WIRE 144 -32 48 -32
WIRE 224 -32 224 -48
WIRE 320 -32 224 -32
WIRE 1600 -32 1600 -128
WIRE 1776 -32 1776 -48
WIRE 2048 -32 2048 -128
WIRE 224 -16 224 -32
WIRE 48 0 48 -32
WIRE 400 16 400 -32
WIRE 496 16 496 -32
WIRE 608 16 608 -32
WIRE 1152 16 1152 -48
WIRE 1408 16 1408 -48
WIRE 272 32 224 32
WIRE 144 64 144 -32
WIRE 176 64 144 64
WIRE -96 80 -96 0
WIRE 1776 80 1776 32
WIRE 1600 96 1600 32
WIRE 48 112 48 80
WIRE 224 112 224 80
WIRE 320 128 320 -32
WIRE 400 128 320 128
WIRE 544 128 496 128
WIRE 1152 128 1152 80
WIRE -304 144 -384 144
WIRE -272 144 -304 144
WIRE -64 144 -272 144
WIRE -32 144 -64 144
WIRE 176 144 -32 144
WIRE 400 160 272 160
WIRE 496 160 496 128
WIRE 496 160 464 160
WIRE 544 160 496 160
WIRE 704 160 608 160
WIRE 912 160 880 160
WIRE -304 176 -304 144
WIRE -64 176 -64 144
WIRE 176 176 176 144
WIRE 1408 176 1408 80
WIRE 704 192 640 192
WIRE 880 192 880 160
WIRE 880 192 768 192
WIRE 912 192 880 192
WIRE 1072 192 976 192
WIRE 1552 192 1472 192
WIRE 1776 192 1776 144
WIRE 1776 192 1744 192
WIRE 576 208 432 208
WIRE 1072 208 1072 192
WIRE 1104 208 1072 208
WIRE 2048 208 2048 48
WIRE -272 224 -272 144
WIRE -272 224 -304 224
WIRE -32 224 -32 144
WIRE -32 224 -64 224
WIRE 176 224 176 192
WIRE -352 256 -384 256
WIRE -112 256 -144 256
WIRE 128 256 96 256
WIRE 576 256 576 224
WIRE -304 288 -304 272
WIRE -192 288 -304 288
WIRE -144 288 -144 256
WIRE -144 288 -192 288
WIRE -64 288 -64 272
WIRE 64 288 -64 288
WIRE 96 288 96 256
WIRE 96 288 64 288
WIRE 176 288 176 272
WIRE 272 288 272 160
WIRE 272 288 176 288
WIRE 448 288 384 288
WIRE 496 288 448 288
WIRE 528 288 496 288
WIRE 1552 288 1456 288
WIRE 1776 288 1744 288
WIRE -304 304 -304 288
WIRE -64 304 -64 288
WIRE 176 304 176 288
WIRE 576 320 576 304
WIRE 640 320 640 192
WIRE 640 320 576 320
WIRE 576 336 576 320
WIRE 1152 336 1152 224
WIRE -256 352 -304 352
WIRE -16 352 -64 352
WIRE 224 352 176 352
WIRE 1776 352 1776 288
WIRE -384 384 -384 256
WIRE -384 384 -496 384
WIRE -352 384 -384 384
WIRE -192 384 -192 288
WIRE -144 384 -144 288
WIRE -112 384 -144 384
WIRE 64 384 64 288
WIRE 96 384 96 288
WIRE 128 384 96 384
WIRE 624 384 576 384
WIRE 384 400 384 368
WIRE 496 416 496 288
WIRE 528 416 496 416
WIRE -304 432 -304 400
WIRE -64 432 -64 400
WIRE 176 432 176 400
WIRE 576 464 576 432
WIRE 448 496 448 288
WIRE 1456 496 1456 288
WIRE 1456 496 448 496
WIRE -496 528 -496 464
WIRE -192 528 -192 464
WIRE -192 528 -496 528
WIRE 64 528 64 448
WIRE 64 528 -192 528
FLAG 384 400 0
FLAG 48 112 0
FLAG -96 80 0
FLAG 400 16 0
FLAG 496 16 0
FLAG 608 16 0
FLAG 1152 336 0
FLAG 1408 176 0
FLAG 1600 96 0
FLAG 1776 352 0
FLAG 672 -128 5v
IOPIN 672 -128 Out
FLAG 1472 192 5v
IOPIN 1472 192 In
FLAG 2048 208 0
FLAG -304 432 0
FLAG -256 352 0
FLAG 176 432 0
FLAG 224 352 0
FLAG -64 432 0
FLAG -16 352 0
FLAG 576 464 0
FLAG 624 384 0
FLAG 224 112 0
FLAG 272 32 0
FLAG -384 144 5v
IOPIN -384 144 In
FLAG 160 -144 5v
IOPIN 160 -144 In
FLAG 432 208 5v
IOPIN 432 208 In
FLAG 1968 -128 out
SYMBOL res -512 368 R0
SYMATTR InstName R1
SYMATTR Value 330k
SYMBOL res -208 368 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMBOL cap 48 384 R0
SYMATTR InstName C1
SYMATTR Value 47p
SYMBOL res 368 272 R0
SYMATTR InstName R3
SYMATTR Value 100k
SYMBOL Digital\\and 432 80 R0
SYMATTR InstName A5
SYMBOL Digital\\and 576 80 R0
SYMATTR InstName A6
SYMBOL Digital\\and 736 112 R0
SYMATTR InstName A7
SYMBOL Digital\\and 944 112 R0
SYMATTR InstName A8
SYMBOL res 32 -176 R0
SYMATTR InstName R4
SYMATTR Value 1Meg
SYMBOL res 32 -16 R0
SYMATTR InstName R5
SYMATTR Value 8.2k
SYMBOL voltage -96 -96 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value SINE(0 100 50)
SYMBOL cap 384 -208 R0
SYMATTR InstName C2
SYMATTR Value 0.44µ
SYMBOL cap 384 -96 R0
SYMATTR InstName C3
SYMATTR Value 2.2µ
SYMBOL diode 528 -112 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMBOL diode 512 -32 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMBOL polcap 592 -96 R0
SYMATTR InstName C4
SYMATTR Value 100µ
SYMBOL ind2 1184 -32 M180
WINDOW 0 4 120 Left 2
WINDOW 3 -2 -20 Left 2
SYMATTR InstName L1
SYMATTR Value 100µ
SYMATTR SpiceLine Rser=0.001m
SYMBOL ind2 1328 -32 R180
WINDOW 0 0 117 Left 2
WINDOW 3 -16 -23 Left 2
SYMATTR InstName L2
SYMATTR Value 100µ
SYMATTR SpiceLine Rser=0.001m
SYMBOL nmos 1104 128 R0
SYMATTR InstName M1
SYMBOL diode 1136 16 R0
SYMATTR InstName D3
SYMBOL diode 1424 80 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMBOL polcap 1584 -32 R0
SYMATTR InstName C5
SYMATTR Value 1000µ
SYMBOL zener 1792 32 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMBOL res 1760 -144 R0
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL diode 1760 80 R0
SYMATTR InstName D6
SYMBOL Optos\\PC817B 1648 240 M0
SYMATTR InstName U1
SYMBOL res 2032 -48 R0
SYMATTR InstName R7
SYMATTR Value 100
SYMBOL pmos4 -352 176 R0
SYMATTR InstName M4
SYMBOL nmos4 -352 304 R0
SYMATTR InstName M5
SYMBOL pmos4 128 176 R0
SYMATTR InstName M6
SYMBOL nmos4 128 304 R0
SYMATTR InstName M7
SYMBOL pmos4 -112 176 R0
SYMATTR InstName M8
SYMBOL nmos4 -112 304 R0
SYMATTR InstName M9
SYMBOL pmos4 528 208 R0
SYMATTR InstName M10
SYMBOL nmos4 528 336 R0
SYMATTR InstName M11
SYMBOL pmos4 176 -144 R0
SYMATTR InstName M12
SYMBOL nmos4 176 -16 R0
SYMATTR InstName M13
TEXT 1200 32 Left 2 !K L1 L2 0.8
TEXT -376 960 Left 2 !.tran 100m
